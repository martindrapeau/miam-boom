/* game/js/cocoonio/cocoon.js*/
(function(){var Cocoon=window.Cocoon||(window.Cocoon={});if(window.cordova&&typeof module!=='undefined'){module.exports=Cocoon;}
Cocoon.version="1.0";Cocoon.extend=function(subc,superc){var subcp=subc.prototype;var CocoonJSExtendHierarchyChainClass=function(){};CocoonJSExtendHierarchyChainClass.prototype=superc.prototype;subc.prototype=new CocoonJSExtendHierarchyChainClass();subc.superclass=superc.prototype;subc.prototype.constructor=subc;if(superc.prototype.constructor===Object.prototype.constructor){superc.prototype.constructor=superc;}
for(var method in subcp){if(subcp.hasOwnProperty(method)){subc.prototype[method]=subcp[method];}}};Cocoon.exec=function(serviceName,functionName,args,succeesCallback,failCallback){if(window.cordova){window.cordova.exec(succeesCallback,failCallback,serviceName,functionName,args);}else{console.error("window.cordova not found");}};Cocoon.define=function(extName,ext,exportToModule){var namespace=(extName.substring(0,7)=="Cocoon.")?extName.substr(7):extName;var base=window.Cocoon;var parts=namespace.split(".");var object=base;for(var i=0;i<parts.length;i++){var part=parts[i];if(!object[part]){console.log("Created namespace: "+extName);}else{console.log("Updated namespace: - "+extName);}
object=object[part]=(i==(parts.length-1))?ext((object[part]||{})):{};if(!object){throw"Unable to create class "+extName;}}
if(arguments.length<2){exportToModule=true;}
if(exportToModule&&typeof module!=='undefined'){module.exports=object;}
return true;};Cocoon.Signal=function(){this.signals={};};Cocoon.Signal.prototype={on:function(eventName,handler){if(!eventName||!handler){throw new Error("Can't create signal "+(eventName||""));}
var listeners=this.signals[eventName];if(!listeners){listeners=[];this.signals[eventName]=listeners;}
listeners.push(handler);},emit:function(eventName,functionName,args){var listeners=this.signals[eventName];if(!listeners){return;}
for(var i=0;i<listeners.length;++i){var func=listeners[i];if(functionName){func=func[functionName];}
if(func){func.apply(null,args||[]);}}},remove:function(eventName,handler){var listeners=this.signals[eventName];if(!listeners){return;}
if(!handler){listeners.lenght=0;}else{for(var i=0;i<listeners.lenght;++i){if(listeners[i]===handler){listeners.splice(i,1);--i;}}}},expose:function(){return this.on.bind(this);}};Cocoon.PlatformType={ANDROID:"android",IOS:"ios",AMAZON:"amazon",WINDOWS_PHONE:"wp",BLACKBERRY:"blackberry",OTHER:"other"};var cachedPlatform;Cocoon.getPlatform=function(){if(cachedPlatform){return cachedPlatform;}
var ua=navigator.userAgent;if(navigator.isCocoonJS){if(/ios/ig.test(ua)){cachedPlatform=Cocoon.PlatformType.IOS;}else{cachedPlatform=Cocoon.PlatformType.ANDROID;}
return cachedPlatform;}
if(/(iPad|iPhone|iPod)/g.test(ua)){cachedPlatform=Cocoon.PlatformType.IOS;}else if(/Kindle/i.test(ua)||/Silk/i.test(ua)||/KFTT/i.test(ua)||/KFOT/i.test(ua)||/KFJWA/i.test(ua)||/KFJWI/i.test(ua)||/KFSOWI/i.test(ua)||/KFTHWA/i.test(ua)||/KFTHWI/i.test(ua)||/KFAPWA/i.test(ua)||/KFAPWI/i.test(ua)){cachedPlatform=Cocoon.PlatformType.AMAZON;}else if(/Android/i.test(ua)){cachedPlatform=Cocoon.PlatformType.ANDROID;}else if(/BlackBerry/i.test(navigator.userAgent)){cachedPlatform=Cocoon.PlatformType.BLACKBERRY;}else if(/IEMobile/i.test(navigator.userAgent)){cachedPlatform=Cocoon.PlatformType.WINDOWS_PHONE;}else{cachedPlatform=Cocoon.PlatformType.OTHER;}
return cachedPlatform;};console.log("Created namespace: Cocoon");})();
/* game/js/cocoonio/cocoon_canvasplus.js*/
(function(){var Cocoon=window.Cocoon;if(!Cocoon&&window.cordova&&typeof require!=='undefined'){require('cocoon-plugin-common.Cocoon');}
Cocoon.nativeAvailable=(!!window.ext);Cocoon.clone=function(obj,copy){if(null===obj||"object"!==typeof obj)return obj;var arr=[];for(var attr in obj){if(copy.hasOwnProperty(attr)){arr.push(copy[attr]);}else{arr.push(obj[attr]);}}
return arr;};Cocoon.callNative=function(nativeExtensionObjectName,nativeFunctionName,args,async){if(Cocoon.nativeAvailable){var argumentsArray=Array.prototype.slice.call(args);argumentsArray.unshift(nativeFunctionName);var nativeExtensionObject=ext[nativeExtensionObjectName];var makeCallFunction=async?nativeExtensionObject.makeCallAsync:nativeExtensionObject.makeCall;var ret=makeCallFunction.apply(nativeExtensionObject,argumentsArray);var finalRet=ret;if(typeof ret==="string"){try{finalRet=JSON.parse(ret);}
catch(error){console.log(error);}}
return finalRet;}};Cocoon.getObjectFromPath=function(baseObject,objectPath){var parts=objectPath.split('.');var obj=baseObject;for(var i=0,len=parts.length;i<len;++i)
{obj[parts[i]]=obj[parts[i]]||undefined;obj=obj[parts[i]];}
return obj;};Cocoon.EventHandler=function(nativeExtensionObjectName,CocoonExtensionObjectName,nativeEventName,chainFunction){this.listeners=[];this.listenersOnce=[];this.chainFunction=chainFunction;this.addEventListener=function(listener){if(chainFunction){var f=function(){chainFunction.call(this,arguments.callee.sourceListener,Array.prototype.slice.call(arguments));};listener.CocoonEventHandlerChainFunction=f;f.sourceListener=listener;listener=f;}
var CocoonExtensionObject=Cocoon.getObjectFromPath(Cocoon,CocoonExtensionObjectName);if(CocoonExtensionObject&&CocoonExtensionObject.nativeAvailable){ext[nativeExtensionObjectName].addEventListener(nativeEventName,listener);}
else{var indexOfListener=this.listeners.indexOf(listener);if(indexOfListener<0){this.listeners.push(listener);}}};this.addEventListenerOnce=function(listener)
{if(chainFunction){var f=function(){chainFunction(arguments.callee.sourceListener,Array.prototype.slice.call(arguments));};f.sourceListener=listener;listener=f;}
var CocoonExtensionObject=Cocoon.getObjectFromPath(Cocoon,CocoonExtensionObjectName);if(CocoonExtensionObject.nativeAvailable){ext[nativeExtensionObjectName].addEventListenerOnce(nativeEventName,listener);}
else
{var indexOfListener=this.listeners.indexOf(listener);if(indexOfListener<0)
{this.listenersOnce.push(listener);}}};this.removeEventListener=function(listener){if(chainFunction){listener=listener.CocoonEventHandlerChainFunction;delete listener.CocoonEventHandlerChainFunction;}
var CocoonExtensionObject=Cocoon.getObjectFromPath(Cocoon,CocoonExtensionObjectName);if(CocoonExtensionObject.nativeAvailable){ext[nativeExtensionObjectName].removeEventListener(nativeEventName,listener);}
else{var indexOfListener=this.listeners.indexOf(listener);if(indexOfListener>=0){this.listeners.splice(indexOfListener,1);}}};this.removeEventListenerOnce=function(listener){if(chainFunction){listener=listener.CocoonEventHandlerChainFunction;delete listener.CocoonEventHandlerChainFunction;}
var CocoonExtensionObject=Cocoon.getObjectFromPath(Cocoon,CocoonExtensionObjectName);if(CocoonExtensionObject.nativeAvailable){ext[nativeExtensionObjectName].removeEventListenerOnce(nativeEventName,listener);}
else{var indexOfListener=this.listenersOnce.indexOf(listener);if(indexOfListener>=0){this.listenersOnce.splice(indexOfListener,1);}}};this.notifyEventListeners=function(){var CocoonExtensionObject=Cocoon.getObjectFromPath(Cocoon,CocoonExtensionObjectName);if(CocoonExtensionObject&&CocoonExtensionObject.nativeAvailable){ext[nativeExtensionObjectName].notifyEventListeners(nativeEventName);}else{var argumentsArray=Array.prototype.slice.call(arguments);var listeners=Array.prototype.slice.call(this.listeners);var listenersOnce=Array.prototype.slice.call(this.listenersOnce);var _this=this;setTimeout(function(){for(var i=0;i<listeners.length;i++){listeners[i].apply(_this,argumentsArray);}
for(i=0;i<listenersOnce.length;i++){listenersOnce[i].apply(_this,argumentsArray);}},0);_this.listenersOnce=[];}};return this;};Cocoon.createSignal=function(){this.handle=null;this.signals={};this.register=function(namespace,handle){if((!namespace)&&(!handle))throw new Error("Can't create signal "+(namespace||""));if(handle.addEventListener){this.signals[namespace]=handle;return true;}
if(!handle.addEventListener){this.signals[namespace]={};for(var prop in handle){if(handle.hasOwnProperty(prop)){this.signals[namespace][prop]=handle[prop];}}
return true;}
throw new Error("Can't create handler for "+namespace+" signal.");};this.expose=function(){return function(signal,callback,params){var once=false;if(arguments.length===1){var that=this;var fnc=function(signal){this.signal=signal;};fnc.prototype.remove=function(functionListener){var handle=that.signals[this.signal];if(handle&&handle.removeEventListener){handle.removeEventListener.apply(that,[functionListener]);that.signals[this.signal]=undefined;}};return new fnc(signal);}
if((params)&&(params.once)){once=true;}
if(!this.signals[signal])throw new Error("The signal "+signal+" does not exists.");var handle=this.signals[signal];if(handle.addEventListener){if(once){handle.addEventListenerOnce(function(){callback.apply(this||window,arguments);});}else{handle.addEventListener(function(){callback.apply(this||window,arguments);});}}
if(!this.signals[signal].addEventListener){for(var prop in this.signals[signal]){if(!this.signals[signal].hasOwnProperty(prop))continue;handle=this.signals[signal][prop];if(once){handle.addEventListenerOnce(function(){this.clbk[this.name].apply(this||window,arguments);}.bind({name:prop,clbk:callback}));}else{handle.addEventListener(function(){this.clbk[this.name].apply(this||window,arguments);}.bind({name:prop,clbk:callback}));}}}}.bind(this);};};window.CocoonJS=window.Cocoon;window.c2cocoonjs=true;})();Cocoon.define("Cocoon.App",function(extension){extension.nativeAvailable=(!!window.ext)&&(!!window.ext.IDTK_APP);extension.isBridgeAvailable=function(){if(Cocoon.App.forward.nativeAvailable==='boolean'){return Cocoon.App.forward.nativeAvailable;}
else{var available=Cocoon.callNative("IDTK_APP","forwardAvailable",arguments);available=!!available;Cocoon.App.forward.nativeAvailable=available;return available;}};var cocoonWebviewIFrame='CocoonJS_App_ForCocoonJS_WebViewIFrame';extension.forward=function(javaScriptCode){if(Cocoon.App.nativeAvailable&&Cocoon.App.isBridgeAvailable()){return Cocoon.callNative("IDTK_APP","forward",arguments);}
else if(!navigator.isCocoonJS){if(window.name===cocoonWebviewIFrame){return window.parent.eval(javaScriptCode);}
else{return window.frames[cocoonWebviewIFrame].window.eval(javaScriptCode);}}};extension.forwardAsync=function(javaScriptCode,returnCallback){if(Cocoon.App.nativeAvailable&&Cocoon.App.isBridgeAvailable()){if(typeof returnCallback!=='undefined'){return ext.IDTK_APP.makeCallAsync("forward",javaScriptCode,returnCallback);}
else{return ext.IDTK_APP.makeCallAsync("forward",javaScriptCode);}}
else{setTimeout(function(){var res;if(window.name===cocoonWebviewIFrame){res=window.parent.eval(javaScriptCode);}
else{res=window.parent.frames[cocoonWebviewIFrame].window.eval(javaScriptCode);}
if(returnCallback){returnCallback(res);}},1);}};extension.load=function(path,storageType){if(Cocoon.App.nativeAvailable){return Cocoon.callNative("IDTK_APP","loadPath",arguments);}
else if(!navigator.isCocoonJS){var xhr=new XMLHttpRequest();xhr.onreadystatechange=function(event){if(xhr.readyState===4){var jsCode;if(xhr.status===200){if(!Cocoon.App.EmulatedWebViewIFrame){jsCode="window.Cocoon && window.Cocoon.App.onLoadInTheWebViewSucceed.notifyEventListeners('"+path+"');";}
else{jsCode="window.Cocoon && window.Cocoon.App.onLoadInCocoonJSSucceed.notifyEventListeners('"+path+"');";}
Cocoon.App.forwardAsync(jsCode);window.location.href=path;}
else if(xhr.status===404){this.onreadystatechange=null;if(!Cocoon.App.EmulatedWebViewIFrame){jsCode="Cocoon && Cocoon.App.onLoadInTheWebViewFailed.notifyEventListeners('"+path+"');";}
else{jsCode="Cocoon && Cocoon.App.onLoadInCocoonJSFailed.notifyEventListeners('"+path+"');";}
Cocoon.App.forwardAsync(jsCode);}}};xhr.open("GET",path,true);xhr.send();}};extension.reload=function(){if(Cocoon.App.nativeAvailable){return Cocoon.callNative("IDTK_APP","reload",arguments);}
else if(!navigator.isCocoonJS){if(window.name===cocoonWebviewIFrame){return window.parent.location.reload();}
else{return window.parent.frames[cocoonWebviewIFrame].window.location.reload();}}};extension.openURL=function(url){if(Cocoon.App.nativeAvailable){return Cocoon.callNative("IDTK_APP","openURL",arguments,true);}
else if(!navigator.isCocoonJS){window.open(url,'_blank');}};extension.exit=function(){if(Cocoon.App.nativeAvailable){return Cocoon.callNative("IDTK_APP","forceToFinish",arguments);}
else if(!navigator.isCocoonJS){window.close();}};extension.StorageType={APP_STORAGE:"APP_STORAGE",INTERNAL_STORAGE:"INTERNAL_STORAGE",EXTERNAL_STORAGE:"EXTERNAL_STORAGE",TEMPORARY_STORAGE:"TEMPORARY_STORAGE"};extension.onSuspended=new Cocoon.EventHandler("IDTK_APP","App","onsuspended");extension.onActivated=new Cocoon.EventHandler("IDTK_APP","App","onactivated");extension.onSuspending=new Cocoon.EventHandler("IDTK_APP","App","onsuspending");extension.onMemoryWarning=new Cocoon.EventHandler("IDTK_APP","App","onmemorywarning");var signal=new Cocoon.createSignal();signal.register("suspended",extension.onSuspended);signal.register("activated",extension.onActivated);signal.register("suspending",extension.onSuspending);signal.register("memorywarning",extension.onMemoryWarning);extension.on=signal.expose();return extension;});if(window.Box2D&&window.Box2D.HEAP32){console.log("The CocoonJS binding for Box2D has been ignored because Box2D Emscripten have been found");}
else if(window.Box2D){console.log("The CocoonJS binding for Box2D has been ignored another Box2D have been found");}
else if(!window.ext||typeof window.ext.IDTK_SRV_BOX2D==='undefined'){console.log("The CocoonJS binding for Box2D has been ignored because ext.IDTK_SRV_BOX2D is not available");}
else{window.Box2D={};window.CocoonBox2D=window.Box2D;window.Box2D.Dynamics={};window.Box2D.Dynamics.Joints={};window.Box2D.Common={};window.Box2D.Common.Math={};window.Box2D.Collision={};window.Box2D.Collision.Shapes={};(function(){"use strict";function b2Err(msg){console.error(msg);}
var B2Vec2=function(x_,y_){if(x_===undefined){x_=0;}
if(y_===undefined){y_=0;}
this.x=x_;this.y=y_;};window.Box2D.Common.Math.b2Vec2=B2Vec2;B2Vec2.prototype.SetZero=function(){this.x=0.0;this.y=0.0;};B2Vec2.prototype.Set=function(x_,y_){if(x_===undefined){x_=0;}
if(y_===undefined){y_=0;}
this.x=x_;this.y=y_;};B2Vec2.prototype.SetV=function(v){if(v===undefined){b2Err("undefined 'v' in b2Vec2.SetV");}
this.x=v.x;this.y=v.y;};B2Vec2.Make=function(x_,y_){if(x_===undefined){x_=0;}
if(y_===undefined){y_=0;}
return new B2Vec2(x_,y_);};if(B2Vec2.Get===undefined){B2Vec2.Get=B2Vec2.Make;B2Vec2._freeCache=[];B2Vec2.Free=function(){};}
B2Vec2.prototype.Copy=function(){return new B2Vec2(this.x,this.y);};B2Vec2.prototype.Add=function(v){if(v===undefined){b2Err("undefined 'v' in b2Vec2.Add");}
this.x+=v.x;this.y+=v.y;};B2Vec2.prototype.Subtract=function(v){if(v===undefined){b2Err("undefined 'v' in b2Vec2.Subtract");}
this.x-=v.x;this.y-=v.y;};B2Vec2.prototype.Multiply=function(a){if(a===undefined){a=0;}
this.x*=a;this.y*=a;};B2Vec2.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y);};B2Vec2.prototype.LengthSquared=function(){return(this.x*this.x+this.y*this.y);};B2Vec2.prototype.Normalize=function(){var length=Math.sqrt(this.x*this.x+this.y*this.y);if(length<Number.MIN_VALUE){return 0.0;}
var invLength=1.0/length;this.x*=invLength;this.y*=invLength;return length;};B2Vec2.prototype.NegativeSelf=function(){this.x=(-this.x);this.y=(-this.y);};var B2Mat22=function(){this.col1=new B2Vec2();this.col2=new B2Vec2();this.SetIdentity();};window.Box2D.Common.Math.b2Mat22=B2Mat22;B2Mat22.FromAngle=function(angle){if(angle===undefined){angle=0;}
var mat=new B2Mat22();mat.Set(angle);return mat;};B2Mat22.FromVV=function(c1,c2){var mat=new B2Mat22();mat.SetVV(c1,c2);return mat;};B2Mat22.prototype.Set=function(angle){if(angle===undefined){angle=0;}
var c=Math.cos(angle);var s=Math.sin(angle);this.col1.x=c;this.col2.x=(-s);this.col1.y=s;this.col2.y=c;};B2Mat22.prototype.SetVV=function(c1,c2){this.col1.SetV(c1);this.col2.SetV(c2);};B2Mat22.prototype.Copy=function(){var mat=new B2Mat22();mat.SetM(this);return mat;};B2Mat22.prototype.SetM=function(m){this.col1.SetV(m.col1);this.col2.SetV(m.col2);};B2Mat22.prototype.AddM=function(m){this.col1.x+=m.col1.x;this.col1.y+=m.col1.y;this.col2.x+=m.col2.x;this.col2.y+=m.col2.y;};B2Mat22.prototype.SetIdentity=function(){this.col1.x=1.0;this.col2.x=0.0;this.col1.y=0.0;this.col2.y=1.0;};B2Mat22.prototype.SetZero=function(){this.col1.x=0.0;this.col2.x=0.0;this.col1.y=0.0;this.col2.y=0.0;};B2Mat22.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x);};B2Mat22.prototype.GetInverse=function(out){var a=this.col1.x;var b=this.col2.x;var c=this.col1.y;var d=this.col2.y;var det=a*d-b*c;if(det!==0.0){det=1.0/det;}
out.col1.x=det*d;out.col2.x=(-det*b);out.col1.y=(-det*c);out.col2.y=det*a;return out;};B2Mat22.prototype.Solve=function(out,bX,bY){if(bX===undefined){bX=0;}
if(bY===undefined){bY=0;}
var a11=this.col1.x;var a12=this.col2.x;var a21=this.col1.y;var a22=this.col2.y;var det=a11*a22-a12*a21;if(det!==0.0){det=1.0/det;}
out.x=det*(a22*bX-a12*bY);out.y=det*(a11*bY-a21*bX);return out;};B2Mat22.prototype.Abs=function(){this.col1.Abs();this.col2.Abs();};var B2Transform=function(pos,r){this.position=new B2Vec2();this.R=new B2Mat22();if(pos===undefined){pos=null;}
if(r===undefined){r=null;}
if(pos){this.position.SetV(pos);this.R.SetM(r);}};window.Box2D.Common.Math.b2Transform=B2Transform;B2Transform.prototype.Initialize=function(pos,r){this.position.SetV(pos);this.R.SetM(r);};B2Transform.prototype.SetIdentity=function(){this.position.SetZero();this.R.SetIdentity();};B2Transform.prototype.Set=function(x){this.position.SetV(x.position);this.R.SetM(x.R);};B2Transform.prototype.SetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x);};var b2Math=function(){};window.Box2D.Common.Math.b2Math=b2Math;b2Math.IsValid=function(x){if(x===undefined){x=0;}
return isFinite(x);};b2Math.Dot=function(a,b){return a.x*b.x+a.y*b.y;};b2Math.CrossVV=function(a,b){return a.x*b.y-a.y*b.x;};b2Math.CrossVF=function(a,s){if(s===undefined){s=0;}
var v=new B2Vec2(s*a.y,(-s*a.x));return v;};b2Math.CrossFV=function(s,a){if(s===undefined){s=0;}
var v=new B2Vec2((-s*a.y),s*a.x);return v;};b2Math.MulMV=function(A,v){if(v===undefined){b2Err("undefined 'v' in b2Math.MulMV");}
var u=new B2Vec2(A.col1.x*v.x+A.col2.x*v.y,A.col1.y*v.x+A.col2.y*v.y);return u;};b2Math.MulTMV=function(A,v){var u=new B2Vec2(b2Math.Dot(v,A.col1),b2Math.Dot(v,A.col2));return u;};b2Math.MulX=function(T,v){var a=b2Math.MulMV(T.R,v);a.x+=T.position.x;a.y+=T.position.y;return a;};b2Math.MulXT=function(T,v){var a=b2Math.SubtractVV(v,T.position);var tX=(a.x*T.R.col1.x+a.y*T.R.col1.y);a.y=(a.x*T.R.col2.x+a.y*T.R.col2.y);a.x=tX;return a;};b2Math.AddVV=function(a,b){var v=new B2Vec2(a.x+b.x,a.y+b.y);return v;};b2Math.SubtractVV=function(a,b){var v=new B2Vec2(a.x-b.x,a.y-b.y);return v;};b2Math.Distance=function(a,b){var cX=a.x-b.x;var cY=a.y-b.y;return Math.sqrt(cX*cX+cY*cY);};b2Math.DistanceSquared=function(a,b){var cX=a.x-b.x;var cY=a.y-b.y;return(cX*cX+cY*cY);};b2Math.MulFV=function(s,a){if(s===undefined){s=0;}
var v=new B2Vec2(s*a.x,s*a.y);return v;};b2Math.AddMM=function(A,B){var C=B2Mat22.FromVV(b2Math.AddVV(A.col1,B.col1),b2Math.AddVV(A.col2,B.col2));return C;};b2Math.MulMM=function(A,B){var C=B2Mat22.FromVV(b2Math.MulMV(A,B.col1),b2Math.MulMV(A,B.col2));return C;};b2Math.MulTMM=function(A,B){var c1=new B2Vec2(b2Math.Dot(A.col1,B.col1),b2Math.Dot(A.col2,B.col1));var c2=new B2Vec2(b2Math.Dot(A.col1,B.col2),b2Math.Dot(A.col2,B.col2));var C=B2Mat22.FromVV(c1,c2);return C;};b2Math.Abs=function(a){if(a===undefined){a=0;}
return a>0.0?a:(-a);};b2Math.AbsV=function(a){var b=new B2Vec2(b2Math.Abs(a.x),b2Math.Abs(a.y));return b;};b2Math.AbsM=function(A){var B=B2Mat22.FromVV(b2Math.AbsV(A.col1),b2Math.AbsV(A.col2));return B;};b2Math.Min=function(a,b){if(a===undefined){a=0;}
if(b===undefined){b=0;}
return a<b?a:b;};b2Math.MinV=function(a,b){var c=new B2Vec2(b2Math.Min(a.x,b.x),b2Math.Min(a.y,b.y));return c;};b2Math.Max=function(a,b){if(a===undefined){a=0;}
if(b===undefined){b=0;}
return a>b?a:b;};b2Math.MaxV=function(a,b){var c=new B2Vec2(b2Math.Max(a.x,b.x),b2Math.Max(a.y,b.y));return c;};b2Math.Clamp=function(a,low,high){if(a===undefined){a=0;}
if(low===undefined){low=0;}
if(high===undefined){high=0;}
return a<low?low:a>high?high:a;};b2Math.ClampV=function(a,low,high){return b2Math.MaxV(low,b2Math.MinV(a,high));};b2Math.Swap=function(a,b){var tmp=a[0];a[0]=b[0];b[0]=tmp;};b2Math.Random=function(){return Math.random()*2-1;};b2Math.RandomRange=function(lo,hi){if(lo===undefined){lo=0;}
if(hi===undefined){hi=0;}
var r=Math.random();r=(hi-lo)*r+lo;return r;};b2Math.NextPowerOfTwo=function(x){if(x===undefined){x=0;}
x|=(x>>1)&0x7FFFFFFF;x|=(x>>2)&0x3FFFFFFF;x|=(x>>4)&0x0FFFFFFF;x|=(x>>8)&0x00FFFFFF;x|=(x>>16)&0x0000FFFF;return x+1;};b2Math.IsPowerOfTwo=function(x){if(x===undefined){x=0;}
var result=x>0&&(x&(x-1))===0;return result;};b2Math.b2Vec2_zero=new B2Vec2(0.0,0.0);b2Math.b2Mat22_identity=B2Mat22.FromVV(new B2Vec2(1.0,0.0),new B2Vec2(0.0,1.0));b2Math.b2Transform_identity=new B2Transform(b2Math.b2Vec2_zero,b2Math.b2Mat22_identity);var B2DebugDraw=function(){this.e_aabbBit=0x0004;this.e_centerOfMassBit=0x0010;this.e_controllerBit=0x0020;this.e_jointBit=0x0002;this.e_pairBit=0x0008;this.e_shapeBit=0x000;};window.Box2D.Dynamics.b2DebugDraw=B2DebugDraw;B2DebugDraw.prototype.AppendFlags=function(){};B2DebugDraw.prototype.ClearFlags=function(){};B2DebugDraw.prototype.DrawCircle=function(){};B2DebugDraw.prototype.DrawPolygon=function(){};B2DebugDraw.prototype.DrawSegment=function(){};B2DebugDraw.prototype.DrawSolidCircle=function(){};B2DebugDraw.prototype.DrawSolidPolygon=function(){};B2DebugDraw.prototype.DrawTransform=function(){};B2DebugDraw.prototype.GetAlpha=function(){};B2DebugDraw.prototype.GetDrawScale=function(){};B2DebugDraw.prototype.GetFillAlpha=function(){};B2DebugDraw.prototype.GetFlags=function(){};B2DebugDraw.prototype.GetLineThickness=function(){};B2DebugDraw.prototype.GetSprite=function(){};B2DebugDraw.prototype.GetXFormScale=function(){};B2DebugDraw.prototype.SetAlpha=function(){};B2DebugDraw.prototype.SetDrawScale=function(){};B2DebugDraw.prototype.SetFillAlpha=function(){};B2DebugDraw.prototype.SetFlags=function(){};B2DebugDraw.prototype.SetLineThickness=function(){};B2DebugDraw.prototype.SetSprite=function(){};B2DebugDraw.prototype.SetXFormScale=function(){};var B2BodyDef=function(){this.position=new B2Vec2(0,0);this.linearVelocity=new B2Vec2();this.userData=null;this.angle=0.0;this.linearVelocity.Set(0,0);this.angularVelocity=0.0;this.linearDamping=0.0;this.angularDamping=0.0;this.allowSleep=true;this.awake=true;this.fixedRotation=false;this.bullet=false;this.type=B2Body.b2_staticBody;this.active=true;this.inertiaScale=1.0;};window.Box2D.Dynamics.b2BodyDef=B2BodyDef;var B2Fixture=function(body,userData,fixtureID,def){this.m_body=body;this.m_userData=userData;this.m_fixtureID=fixtureID;this.m_shape={};this.m_shape.m_centroid=new B2Vec2();this.m_isSensor=false;this.m_density=def.density;this.m_friction=def.friction;this.m_restitution=def.restitution;this.m_isSensor=def.isSensor;};window.Box2D.Dynamics.b2Fixture=B2Fixture;B2Fixture.prototype.GetBody=function(){return this.m_body;};B2Fixture.prototype.GetShape=function(){console.log("fixture.GetShape not yet supported in CocoonJS Box2D binding");return null;};B2Fixture.prototype.GetUserData=function(){return this.m_userData;};B2Fixture.prototype.SetSensor=function(isSensor){this.m_isSensor=isSensor;window.ext.IDTK_SRV_BOX2D.makeCall("setSensor",this.m_body.m_world.m_worldID,this.m_fixtureID,this.m_isSensor);};B2Fixture.prototype.IsSensor=function(){return this.m_isSensor;};B2Fixture.prototype.SetDensity=function(density){window.ext.IDTK_SRV_BOX2D.makeCall("setDensity",this.m_body.m_world.m_worldID,this.m_fixtureID,density);this.m_density=density;};B2Fixture.prototype.SetFriction=function(friction){window.ext.IDTK_SRV_BOX2D.makeCall("setFriction",this.m_body.m_world.m_worldID,this.m_fixtureID,friction);this.m_friction=friction;};B2Fixture.prototype.SetRestitution=function(restitution){window.ext.IDTK_SRV_BOX2D.makeCall("setRestitution",this.m_body.m_world.m_worldID,this.m_fixtureID,restitution);this.m_restitution=restitution;};B2Fixture.prototype.GetDensity=function(){return this.m_density;};B2Fixture.prototype.GetFriction=function(){return this.m_friction;};B2Fixture.prototype.GetRestitution=function(){return this.m_restitution;};var B2Body=function(bd,world){var userData=bd.userData;bd.userData=null;this.m_world=world;this.m_xf=new B2Transform(bd.position,B2Mat22.FromAngle(bd.angle));this.m_fixtures=[];this.m_active=bd.active;if(bd.type===B2Body.b2_staticBody){bd.density=0;}
this.m_bodyID=window.ext.IDTK_SRV_BOX2D.makeCall("createBody",world.m_worldID,bd);this.m_userData=userData;bd.userData=userData;};window.Box2D.Dynamics.b2Body=B2Body;B2Body.prototype.CreateFixture=function(def){var userData=def.userData;def.userData=null;var fixtureID=window.ext.IDTK_SRV_BOX2D.makeCall("createFixture",this.m_world.m_worldID,this.m_bodyID,def);def.userData=userData;var fixture=new B2Fixture(this,userData,fixtureID,def);this.m_world.m_fixturesList[fixtureID]=fixture;this.m_fixtures.push(fixture);return fixture;};B2Body.prototype.GetFixtureList=function(){if(this.m_fixtures.length===0){return null;}
return this.m_fixtures[0];};B2Body.prototype.DestroyFixture=function(fixture){window.ext.IDTK_SRV_BOX2D.makeCall("deleteFixture",this.m_world.m_worldID,fixture.m_fixtureID);delete this.m_world.m_fixturesList[fixture.m_fixtureID];};B2Body.prototype.SetPositionAndAngle=function(position,angle){window.ext.IDTK_SRV_BOX2D.makeCall("setBodyTransform",this.m_world.m_worldID,this.m_bodyID,position.x,position.y,angle);this.m_xf.R.Set(angle);this.m_xf.position.SetV(position);};B2Body.prototype.GetPosition=function(){return this.m_xf.position;};B2Body.prototype.SetPosition=function(position){this.SetPositionAndAngle(position,this.GetAngle());};B2Body.prototype.GetLinearVelocity=function(){var v=window.ext.IDTK_SRV_BOX2D.makeCall("getLinearVelocity",this.m_world.m_worldID,this.m_bodyID);return new B2Vec2(v[0],v[1]);};B2Body.prototype.GetWorldCenter=function(){var p=window.ext.IDTK_SRV_BOX2D.makeCall("getWorldCenter",this.m_world.m_worldID,this.m_bodyID);return new B2Vec2(p[0],p[1]);};B2Body.prototype.GetLocalCenter=function(){var p=window.ext.IDTK_SRV_BOX2D.makeCall("getLocalCenter",this.m_world.m_worldID,this.m_bodyID);return new B2Vec2(p[0],p[1]);};B2Body.prototype.GetLocalPoint=function(worldPoint){return b2Math.MulXT(this.m_xf,worldPoint);};B2Body.prototype.ApplyImpulse=function(impulse,point,wake){window.ext.IDTK_SRV_BOX2D.makeCall("applyImpulse",this.m_world.m_worldID,this.m_bodyID,impulse.x,impulse.y,point.x,point.y,wake);};B2Body.prototype.GetMass=function(){return window.ext.IDTK_SRV_BOX2D.makeCall("getMass",this.m_world.m_worldID,this.m_bodyID);};B2Body.prototype.IsAwake=function(){return window.ext.IDTK_SRV_BOX2D.makeCall("isAwake",this.m_world.m_worldID,this.m_bodyID);};B2Body.prototype.GetAngularVelocity=function(){return window.ext.IDTK_SRV_BOX2D.makeCall("getAngularVelocity",this.m_world.m_worldID,this.m_bodyID);};B2Body.prototype.SetFixedRotation=function(fixed){window.ext.IDTK_SRV_BOX2D.makeCall("setFixedRotation",this.m_world.m_worldID,this.m_bodyID,fixed);};B2Body.prototype.SetAwake=function(state){window.ext.IDTK_SRV_BOX2D.makeCall("setAwake",this.m_world.m_worldID,this.m_bodyID,state);};B2Body.prototype.SetLinearVelocity=function(vel){window.ext.IDTK_SRV_BOX2D.makeCall("setLinearVelocity",this.m_world.m_worldID,this.m_bodyID,vel.x,vel.y);};B2Body.prototype.ApplyForceToCenter=function(force,wake){window.ext.IDTK_SRV_BOX2D.makeCall("applyForceToCenter",this.m_world.m_worldID,this.m_bodyID,force.x,force.y,wake);};B2Body.prototype.ApplyForce=function(force,point,wake){window.ext.IDTK_SRV_BOX2D.makeCall("applyForce",this.m_world.m_worldID,this.m_bodyID,force.x,force.y,point.x,point.y,wake);};B2Body.prototype.ApplyTorque=function(torque,wake){window.ext.IDTK_SRV_BOX2D.makeCall("applyTorque",this.m_world.m_worldID,this.m_bodyID,torque,wake);};B2Body.prototype.SetLinearDamping=function(damp){window.ext.IDTK_SRV_BOX2D.makeCall("setLinearDamping",this.m_world.m_worldID,this.m_bodyID,damp);};B2Body.prototype.SetAngularVelocity=function(angvel){window.ext.IDTK_SRV_BOX2D.makeCall("setAngularVelocity",this.m_world.m_worldID,this.m_bodyID,angvel);};B2Body.prototype.SetType=function(type){window.ext.IDTK_SRV_BOX2D.makeCall("setType",this.m_world.m_worldID,this.m_bodyID,type);};B2Body.prototype.SetActive=function(state){window.ext.IDTK_SRV_BOX2D.makeCall("setActive",this.m_world.m_worldID,this.m_bodyID,state);this.m_active=state;};B2Body.prototype.IsActive=function(){return this.m_active;};B2Body.prototype.GetAngle=function(){return this.m_xf.R.GetAngle();};B2Body.prototype.SetAngle=function(angle){if(angle===undefined){angle=0;}
this.SetPositionAndAngle(this.GetPosition(),angle);};B2Body.prototype.GetContactList=function(){var contacts=window.ext.IDTK_SRV_BOX2D.makeCall("getObjectContacts",this.m_world.m_worldID,this.m_bodyID);var result=[];for(var i=0;i<contacts.length;i++){result.push(this.m_world.m_bodyList[contacts[i]]);}
return result;};B2Body.prototype.SetUserData=function(data){this.m_userData=data;};B2Body.prototype.GetUserData=function(){return this.m_userData;};B2Body.prototype.GetWorld=function(){return this.m_world;};window.Box2D.Dynamics.b2Body.b2_staticBody=0;window.Box2D.Dynamics.b2Body.b2_kinematicBody=1;window.Box2D.Dynamics.b2Body.b2_dynamicBody=2;var B2Contact=function(fixtureA,fixtureB,touching){this.m_fixtureA=fixtureA;this.m_fixtureB=fixtureB;this.m_touching=touching;};window.Box2D.Dynamics.b2Contact=B2Contact;B2Contact.prototype.GetFixtureA=function(){return this.m_fixtureA;};B2Contact.prototype.GetFixtureB=function(){return this.m_fixtureB;};B2Contact.prototype.IsTouching=function(){return this.m_touching;};var B2ContactListener=function(){};window.Box2D.Dynamics.b2ContactListener=B2ContactListener;B2ContactListener.prototype.BeginContact=function(){};B2ContactListener.prototype.EndContact=function(){};B2ContactListener.prototype.PreSolve=function(){};B2ContactListener.prototype.PostSolve=function(){};window.Box2D.Dynamics.b2ContactListener.b2_defaultListener=new B2ContactListener();var B2ContactFilter=function(){};window.Box2D.Dynamics.b2ContactFilter=B2ContactFilter;var B2World=function(gravity,doSleep){this.m_bodyList=[];this.m_jointList=[];this.m_fixturesList=[];this.m_contactListener=null;this.m_jointsList=[];this.m_worldID=window.ext.IDTK_SRV_BOX2D.makeCall("createWorld",gravity.x,gravity.y,doSleep);};window.Box2D.Dynamics.b2World=B2World;B2World.prototype.SetContactListener=function(listener){this.m_contactListener=listener;};B2World.prototype.SetContactFilter=function(filter){var _filter=filter;var world=this;var callbackFunc=function(a,b){var fa=world.m_fixturesList[a];var fb=world.m_fixturesList[b];return _filter.ShouldCollide(fa,fb);};window.ext.IDTK_SRV_BOX2D.makeCall("setContactFilter",this.m_worldID,callbackFunc);};B2World.prototype.CreateBody=function(def){var b=new B2Body(def,this);this.m_bodyList[b.m_bodyID]=b;return b;};B2World.prototype.DestroyBody=function(b){window.ext.IDTK_SRV_BOX2D.makeCall("deleteBody",this.m_worldID,b.m_bodyID);delete this.m_bodyList[b.m_bodyID];for(var i=0;i<b.m_fixtures.length;++i){delete this.m_fixturesList[b.m_fixtures[i].m_fixtureID];}};B2World.prototype.CreateJoint=function(def){if(def.bodyA.m_bodyID===def.bodyB.m_bodyID){return;}
var bodyA=def.bodyA;var bodyB=def.bodyB;def.bodyA=bodyA.m_bodyID;def.bodyB=bodyB.m_bodyID;var jointFunc="createDistanceJoint";if(def.type===B2Joint.e_revoluteJoint){jointFunc="createRevoluteJoint";}
var joint=new B2Joint(def);joint.m_jointID=window.ext.IDTK_SRV_BOX2D.makeCall(jointFunc,this.m_worldID,def);def.bodyA=bodyA;def.bodyB=bodyB;this.m_jointsList.push(joint);return joint;};B2World.prototype.DestroyJoint=function(joint){window.ext.IDTK_SRV_BOX2D.makeCall("destroyJoint",this.m_worldID,joint.m_jointID);};B2World.prototype.GetJointList=function(){if(this.m_jointsList.length===0){return null;}
for(var i=0;i<this.m_jointsList.length-1;++i){this.m_jointsList[i].next=this.m_jointsList[i+1];}
this.m_jointsList[this.m_jointsList.length-1].next=null;return this.m_jointsList[0];};B2World.prototype.SetContinuousPhysics=function(continuous){window.ext.IDTK_SRV_BOX2D.makeCall("setContinuous",this.m_worldID,continuous);};B2World.prototype.SetGravity=function(gravity){window.ext.IDTK_SRV_BOX2D.makeCall("setGravity",this.m_worldID,gravity.x,gravity.y);};B2World.prototype.Step=function(dt,velocityIterations,positionIterations){var i;var transforms=window.ext.IDTK_SRV_BOX2D.makeCall("step",this.m_worldID,dt,velocityIterations,positionIterations);var count=transforms[0];for(i=1;i<=count*4;i+=4){var body=this.m_bodyList[transforms[i+0]];if(body===null){break;}
body.m_xf.position.Set(transforms[i+1],transforms[i+2]);body.m_xf.R.Set(transforms[i+3]);}
if(this.m_contactListener!==null){var contacts=window.ext.IDTK_SRV_BOX2D.makeCall("getLastContacts",this.m_worldID);count=contacts[0];for(i=1;i<=count*3;i+=3){var f1=contacts[i+0];var f2=contacts[i+1];var touching=contacts[i+2];var fix1=this.m_fixturesList[f1];var fix2=this.m_fixturesList[f2];if((typeof(fix1)==='undefined')||(typeof(fix2)==='undefined')){console.log("One of the fixtures in a contact DOESN'T EXIST!!");continue;}
this.m_contactListener.BeginContact(new B2Contact(fix1,fix2,touching));}}};B2World.prototype.ClearForces=function(){window.ext.IDTK_SRV_BOX2D.makeCall("clearForces",this.m_worldID);};B2World.prototype.SetDebugDraw=function(){};B2World.prototype.DrawDebugData=function(){};window.Box2D.Collision.Shapes.b2CircleShape=function(radius){this.radius=radius;this.type="circle";};window.Box2D.Collision.Shapes.b2PolygonShape=function(){this.SetAsBox=function(width,height){this.type="box";this.width=width;this.height=height;};this.SetAsEdge=function(v1,v2){this.type="edge";this.p1x=v1.x;this.p1y=v1.y;this.p2x=v2.x;this.p2y=v2.y;};this.SetAsArray=function(vec,length){this.type="polygon";this.vertices=[];for(var i=0;i<length;i++){this.vertices.push(vec[i].x);this.vertices.push(vec[i].y);}};};var b2FixtureDef=function(){this.shape=null;this.userData=null;this.friction=0.2;this.restitution=0.0;this.density=0.0;this.isSensor=false;this.filter={categoryBits:1,maskBits:0xFFFF,groupIndex:0};};window.Box2D.Dynamics.b2FixtureDef=b2FixtureDef;var B2Joint=function(def){this.bodyA=def.bodyA;this.bodyB=def.bodyB;this.userData=def.userData;this.type=def.type;this.next=null;};window.Box2D.Dynamics.Joints.b2Joint=B2Joint;B2Joint.prototype.GetBodyA=function(){return this.bodyA;};B2Joint.prototype.GetBodyB=function(){return this.bodyB;};B2Joint.prototype.GetUserData=function(){return this.userData;};B2Joint.prototype.GetType=function(){return this.type;};B2Joint.prototype.GetNext=function(){return this.next;};B2Joint.e_distanceJoint=0;B2Joint.e_revoluteJoint=1;var B2DistanceJointDef=function(bA,bB,anchorA,anchorB){this.type=B2Joint.e_distanceJoint;this.localAnchorA=new B2Vec2();this.localAnchorB=new B2Vec2();this.userData=null;if(bA!==undefined){this.bodyA=bA;}
if(bB!==undefined){this.bodyB=bB;}
if(anchorA!==undefined){this.localAnchorA.SetV(anchorA);}
if(anchorB!==undefined){this.localAnchorB.SetV(anchorB);}
if(anchorA!==undefined&&anchorB!==undefined){var dX=anchorB.x-anchorA.x;var dY=anchorB.y-anchorA.y;this.length=Math.sqrt(dX*dX+dY*dY);}
this.frequencyHz=0.0;this.dampingRatio=0.0;};window.Box2D.Dynamics.Joints.b2DistanceJointDef=B2DistanceJointDef;var B2RevoluteJointDef=function(bA,bB,anchorA,anchorB){this.type=B2Joint.e_revoluteJoint;this.localAnchorA=new B2Vec2();this.localAnchorB=new B2Vec2();this.userData=null;if(bA!==undefined){this.bodyA=bA;}
if(bB!==undefined){this.bodyB=bB;}
if(anchorA!==undefined){this.localAnchorA.SetV(anchorA);}
if(anchorB!==undefined){this.localAnchorB.SetV(anchorB);}
this.referenceAngle=0.0;this.lowerAngle=0.0;this.upperAngle=0.0;this.maxMotorTorque=0.0;this.motorSpeed=0.0;this.enableLimit=false;this.enableMotor=false;};B2RevoluteJointDef.prototype.Initialize=function(bA,bB,anchor){this.bodyA=bA;this.bodyB=bB;this.localAnchorA=this.bodyA.GetLocalPoint(anchor);this.localAnchorB=this.bodyB.GetLocalPoint(anchor);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle();};window.Box2D.Dynamics.Joints.b2RevoluteJointDef=B2RevoluteJointDef;})();}
Cocoon.define("Cocoon.Device",function(extension){"use strict";extension.DeviceInfo={os:null,version:null,dpi:null,brand:null,model:null,imei:null,platformId:null,odin:null,openudid:null};extension.getDeviceId=function(){if(Cocoon.nativeAvailable){return window.ext.IDTK_APP.makeCall("getDeviceId");}};extension.getDeviceInfo=function(){if(Cocoon.nativeAvailable){return window.ext.IDTK_APP.makeCall("getDeviceInfo");}};extension.getOrientation=function(){if(Cocoon.nativeAvailable){return window.ext.IDTK_APP.makeCall("getPreferredOrientation");}
else{return 0;}};extension.setOrientation=function(preferredOrientation){if(Cocoon.nativeAvailable){window.ext.IDTK_APP.makeCall("setPreferredOrientation",preferredOrientation);}};extension.Orientations={PORTRAIT:1,PORTRAIT_UPSIDE_DOWN:2,LANDSCAPE_LEFT:4,LANDSCAPE_RIGHT:8,LANDSCAPE:4|8,BOTH:1|2|4|8};extension.autoLock=function(enabled){if(Cocoon.nativeAvailable){return Cocoon.callNative("IDTK_APP","setAutoLockEnabled",arguments);}};return extension;});Cocoon.define("Cocoon.Dialog",function(extension){"use strict";extension.keyboardType={TEXT:"text",NUMBER:"num",PHONE:"phone",EMAIL:"email",URL:"url"};extension.prompt=function(params,callbacks){if(!callbacks)throw("Callback missing for Cocoon.Dialog.prompt();");var defaultKeyboard=Cocoon.Dialog.keyboardType.TEXT;switch(params.type){case Cocoon.Dialog.keyboardType.TEXT:defaultKeyboard=Cocoon.Dialog.keyboardType.TEXT;break;case Cocoon.Dialog.keyboardType.NUMBER:defaultKeyboard=Cocoon.Dialog.keyboardType.NUMBER;break;case Cocoon.Dialog.keyboardType.PHONE:defaultKeyboard=Cocoon.Dialog.keyboardType.PHONE;break;case Cocoon.Dialog.keyboardType.EMAIL:defaultKeyboard=Cocoon.Dialog.keyboardType.EMAIL;break;case Cocoon.Dialog.keyboardType.URL:defaultKeyboard=Cocoon.Dialog.keyboardType.URL;break;}
var properties={title:"",message:"",text:"",type:defaultKeyboard,cancelText:"Cancel",confirmText:"Ok",secureText:false};var args=Cocoon.clone(properties,params);var succedListener=function(){Cocoon.Dialog.onTextDialogCancelled.removeEventListener(errorListener);Cocoon.Dialog.onTextDialogFinished.removeEventListener(succedListener);callbacks.success.apply(window,Array.prototype.slice.call(arguments));};var errorListener=function(){Cocoon.Dialog.onTextDialogCancelled.removeEventListener(errorListener);Cocoon.Dialog.onTextDialogFinished.removeEventListener(succedListener);callbacks.cancel.apply(window,Array.prototype.slice.call(arguments));};Cocoon.Dialog.onTextDialogCancelled.addEventListener(errorListener);Cocoon.Dialog.onTextDialogFinished.addEventListener(succedListener);if(Cocoon.App.nativeAvailable){return Cocoon.callNative("IDTK_APP","showTextDialog",args,true);}else{setTimeout(function(){var result=prompt(properties.message,properties.text);var eventObject=result?Cocoon.Dialog.onTextDialogFinished:Cocoon.Dialog.onTextDialogCancelled;eventObject.notifyEventListeners(result);},0);}};extension.confirm=function(params,callback){if(!callback)throw("Callback missing for Cocoon.Dialog.confirm();");var properties={title:"",message:"",cancelText:"Cancel",confirmText:"Ok"};var args=Cocoon.clone(properties,params);var succedListener=function(){Cocoon.Dialog.onMessageBoxDenied.removeEventListenerOnce(errorListener);callback(true);};var errorListener=function(){Cocoon.Dialog.onMessageBoxConfirmed.removeEventListenerOnce(succedListener);callback(false);};Cocoon.Dialog.onMessageBoxDenied.addEventListenerOnce(errorListener);Cocoon.Dialog.onMessageBoxConfirmed.addEventListenerOnce(succedListener);if(Cocoon.nativeAvailable){return Cocoon.callNative("IDTK_APP","showMessageBox",args,true);}else{setTimeout(function(){var result=confirm(properties.message);var eventObject=result?Cocoon.Dialog.onMessageBoxConfirmed:Cocoon.Dialog.onMessageBoxDenied;eventObject.notifyEventListeners();},0);}};extension.showKeyboard=function(params,callbacks){params=params||{};params.type=params.type||Cocoon.Dialog.keyboardType.TEXT;var insertCallback=callbacks&&callbacks.insertText;var deleteCallback=callbacks&&callbacks.deleteBackward;var doneCallback=callbacks&&callbacks.done;var cancelCallback=callbacks&&callbacks.cancel;if(Cocoon.nativeAvailable){Cocoon.callNative("IDTK_APP","showKeyboard",[params,insertCallback,deleteCallback,doneCallback,cancelCallback],true);}};extension.dismissKeyboard=function(){if(Cocoon.nativeAvailable){Cocoon.callNative("IDTK_APP","dismissKeyboard",[],true);}};extension.onTextDialogFinished=new Cocoon.EventHandler("IDTK_APP","App","ontextdialogfinish");extension.onTextDialogCancelled=new Cocoon.EventHandler("IDTK_APP","App","ontextdialogcancel");extension.onMessageBoxConfirmed=new Cocoon.EventHandler("IDTK_APP","App","onmessageboxconfirmed");extension.onMessageBoxDenied=new Cocoon.EventHandler("IDTK_APP","App","onmessageboxdenied");return extension;});Cocoon.define("Cocoon.Motion",function(extension){"use strict";extension.nativeAvailable=Cocoon.nativeAvailable;extension.setAccelerometerInterval=function(updateIntervalInSeconds){if(Cocoon.Motion.nativeAvailable){return window.ext.IDTK_APP.makeCall("setAccelerometerUpdateIntervalInSeconds",updateIntervalInSeconds);}};extension.getAccelerometerInterval=function(){if(Cocoon.Motion.nativeAvailable){return window.ext.IDTK_APP.makeCall("getAccelerometerUpdateIntervalInSeconds");}};extension.setGyroscopeInterval=function(updateIntervalInSeconds){if(Cocoon.Motion.nativeAvailable){return window.ext.IDTK_APP.makeCall("setGyroscopeUpdateIntervalInSeconds",updateIntervalInSeconds);}};extension.getGyroscopeInterval=function(){if(Cocoon.Motion.nativeAvailable){window.ext.IDTK_APP.makeCall("getGyroscopeUpdateIntervalInSeconds");}};return extension;});Cocoon.define("Cocoon.App",function(extension){function checkEmulatedWebViewReady(){var emulatedWB=Cocoon.App.EmulatedWebView;if(emulatedWB){return;}
emulatedWB=document.createElement('div');emulatedWB.setAttribute('id','CocoonJS_App_ForCocoonJS_WebViewDiv');emulatedWB.style.width=0;emulatedWB.style.height=0;emulatedWB.style.position="absolute";emulatedWB.style.left=0;emulatedWB.style.top=0;emulatedWB.style.backgroundColor='transparent';emulatedWB.style.border="0px solid #000";var frame=document.createElement("IFRAME");frame.setAttribute('id','CocoonJS_App_ForCocoonJS_WebViewIFrame');frame.setAttribute('name','CocoonJS_App_ForCocoonJS_WebViewIFrame');frame.style.width=0;frame.style.height=0;frame.frameBorder=0;frame.allowtransparency=true;emulatedWB.appendChild(frame);Cocoon.App.EmulatedWebView=emulatedWB;Cocoon.App.EmulatedWebViewIFrame=frame;if(!document.body){document.body=document.createElement("body");}
document.body.appendChild(Cocoon.App.EmulatedWebView);}
extension.pause=function()
{if(Cocoon.App.nativeAvailable)
{return Cocoon.callNative("IDTK_APP","pause",arguments);}};extension.resume=function()
{if(Cocoon.App.nativeAvailable)
{return Cocoon.callNative("IDTK_APP","resume",arguments);}};extension.loadInTheWebView=function(path,storageType)
{if(navigator.isCocoonJS&&Cocoon.App.nativeAvailable)
{Cocoon.callNative("IDTK_APP","loadInTheWebView",arguments);}
else
{var xhr=new XMLHttpRequest();xhr.onreadystatechange=function(event){if(xhr.readyState===4)
{if((xhr.status>=200&&xhr.status<=299)||xhr.status===0)
{checkEmulatedWebViewReady();var callback=function(event){Cocoon.App.onLoadInTheWebViewSucceed.notifyEventListeners(path);Cocoon.App.EmulatedWebViewIFrame.removeEventListener("load",callback);};Cocoon.App.EmulatedWebViewIFrame.addEventListener("load",callback);Cocoon.App.EmulatedWebViewIFrame.contentWindow.location.href=path;}
else
{this.onreadystatechange=null;Cocoon.App.onLoadInTheWebViewFailed.notifyEventListeners(path);}}};xhr.open("GET",path,true);xhr.send();}};extension.reloadWebView=function()
{if(Cocoon.App.nativeAvailable&&navigator.isCocoonJS)
{Cocoon.callNative("IDTK_APP","reloadWebView",arguments);}
else
{checkEmulatedWebViewReady();Cocoon.App.EmulatedWebViewIFrame.contentWindow.location.reload();}};extension.showTheWebView=function(x,y,width,height)
{if(Cocoon.App.nativeAvailable&&navigator.isCocoonJS)
{Cocoon.callNative("IDTK_APP","showTheWebView",arguments);}
else
{checkEmulatedWebViewReady();Cocoon.App.EmulatedWebViewIFrame.style.width=(width?width/window.devicePixelRatio:window.innerWidth)+'px';Cocoon.App.EmulatedWebViewIFrame.style.height=(height?height/window.devicePixelRatio:window.innerHeight)+'px';Cocoon.App.EmulatedWebView.style.left=(x?x:0)+'px';Cocoon.App.EmulatedWebView.style.top=(y?y:0)+'px';Cocoon.App.EmulatedWebView.style.width=(width?width/window.devicePixelRatio:window.innerWidth)+'px';Cocoon.App.EmulatedWebView.style.height=(height?height/window.devicePixelRatio:window.innerHeight)+'px';Cocoon.App.EmulatedWebView.style.display="block";}};extension.hideTheWebView=function(){if(Cocoon.App.nativeAvailable&&navigator.isCocoonJS){var javaScriptCodeToForward="ext.IDTK_APP.makeCall('hide');";return Cocoon.App.forwardAsync(javaScriptCodeToForward);}
else{checkEmulatedWebViewReady();Cocoon.App.EmulatedWebView.style.display="none";}};extension.forwardedEventFromTheWebView=function(eventName,eventDataString){var eventData=JSON.parse(eventDataString);eventData.target=window;var event=new Event(eventName);for(var att in eventData){event[att]=eventData[att];}
event.target=window;window.dispatchEvent(event);var canvases=document.getElementsByTagName("canvas");for(var i=0;i<canvases.length;i++){event.target=canvases[i];canvases[i].dispatchEvent(event);}};extension.onLoadInTheWebViewSucceed=new Cocoon.EventHandler("IDTK_APP","App","forwardpageload");extension.onLoadInTheWebViewFailed=new Cocoon.EventHandler("IDTK_APP","App","forwardpagefail");var signal=new Cocoon.createSignal();signal.register("load",{success:extension.onLoadInTheWebViewSucceed,error:extension.onLoadInTheWebViewFailed});extension.WebView=Cocoon.WebView||{};extension.WebView.on=signal.expose();return extension;});Cocoon.define("Cocoon.Proxify",function(extension){"use strict";extension.getKeyForValueInDictionary=function(dictionary,value){var finalKey=null;for(var key in dictionary){if(dictionary[key]===value){finalKey=key;break;}}
return finalKey;};extension.setupOriginProxyType=function(typeName,attributeNames,functionNames,eventHandlerNames){if(Cocoon.nativeAvailable){if(!typeName)throw"The given typeName must be valid.";if(!attributeNames&&!functionNames&&!eventHandlerNames)throw"There is no point on setting up a proxy for no attributes, functions nor eventHandlers.";attributeNames=attributeNames?attributeNames:[];functionNames=functionNames?functionNames:[];eventHandlerNames=eventHandlerNames?eventHandlerNames:[];var parentObject=window;var jsCode="Cocoon.Proxify.setupDestinationProxyType("+JSON.stringify(typeName)+", "+JSON.stringify(eventHandlerNames)+");";Cocoon.App.forward(jsCode);var originalType=parentObject[typeName];parentObject[typeName]=function(){var _this=this;this._cocoonjs_proxy_object_data={};var jsCode="Cocoon.Proxify.newDestinationProxyObject("+JSON.stringify(typeName)+");";this._cocoonjs_proxy_object_data.id=Cocoon.App.forward(jsCode);this._cocoonjs_proxy_object_data.eventHandlers={};this._cocoonjs_proxy_object_data.typeName=typeName;this._cocoonjs_proxy_object_data.eventListeners={};parentObject[typeName]._cocoonjs_proxy_type_data.proxyObjects[this._cocoonjs_proxy_object_data.id]=this;for(var i=0;i<attributeNames.length;i++){(function(attributeName){_this.__defineSetter__(attributeName,function(value){var jsCode="Cocoon.Proxify.setDestinationProxyObjectAttribute("+JSON.stringify(typeName)+", "+_this._cocoonjs_proxy_object_data.id+", "+JSON.stringify(attributeName)+", "+JSON.stringify(value)+");";return Cocoon.App.forward(jsCode);});_this.__defineGetter__(attributeName,function(){var jsCode="Cocoon.Proxify.getDestinationProxyObjectAttribute("+JSON.stringify(typeName)+", "+_this._cocoonjs_proxy_object_data.id+", "+JSON.stringify(attributeName)+");";return Cocoon.App.forward(jsCode);});})(attributeNames[i]);}
for(i=0;i<functionNames.length;i++){(function(functionName){_this[functionName]=function(){var argumentsArray=Array.prototype.slice.call(arguments);argumentsArray.unshift(functionName);argumentsArray.unshift(this._cocoonjs_proxy_object_data.id);argumentsArray.unshift(typeName);var jsCode="Cocoon.Proxify.callDestinationProxyObjectFunction(";for(var i=0;i<argumentsArray.length;i++){jsCode+=(i!==1?JSON.stringify(argumentsArray[i]):argumentsArray[i])+(i<argumentsArray.length-1?", ":"");}
jsCode+=");";var ret=Cocoon.App.forwardAsync(jsCode);return ret;};})(functionNames[i]);}
for(i=0;i<eventHandlerNames.length;i++){(function(eventHandlerName){_this.__defineSetter__(eventHandlerName,function(value){_this._cocoonjs_proxy_object_data.eventHandlers[eventHandlerName]=value;});_this.__defineGetter__(eventHandlerName,function(){return _this._cocoonjs_proxy_object_data.eventHandlers[eventHandlerName];});})(eventHandlerNames[i]);}
_this.addEventListener=function(eventTypeName,eventCallback){var addEventCallback=true;var eventListeners=_this._cocoonjs_proxy_object_data.eventListeners[eventTypeName];if(eventListeners){addEventCallback=eventListeners.indexOf(eventCallback)<0;}
else{eventListeners=[];_this._cocoonjs_proxy_object_data.eventListeners[eventTypeName]=eventListeners;var jsCode="Cocoon.Proxify.addDestinationProxyObjectEventListener("+JSON.stringify(_this._cocoonjs_proxy_object_data.typeName)+", "+_this._cocoonjs_proxy_object_data.id+", "+JSON.stringify(eventTypeName)+");";Cocoon.App.forwardAsync(jsCode);}
if(addEventCallback){eventListeners.push(eventCallback);}};_this.removeEventListener=function(eventTypeName,eventCallback){var eventListeners=_this._cocoonjs_proxy_object_data.eventListeners[eventTypeName];if(eventListeners){var eventCallbackIndex=eventListeners.indexOf(eventCallback);if(eventCallbackIndex>=0){eventListeners.splice(eventCallbackIndex,1);}}};return this;};parentObject[typeName]._cocoonjs_proxy_type_data={originalType:originalType,proxyObjects:[]};parentObject[typeName]._cocoonjs_proxy_type_data.deleteProxyObject=function(object){var proxyObjectKey=extension.getKeyForValueInDictionary(this.proxyObjects,object);if(proxyObjectKey){var jsCode="Cocoon.Proxify.deleteDestinationProxyObject("+JSON.stringify(typeName)+", "+object._cocoonjs_proxy_object_data.id+");";Cocoon.App.forwardAsync(jsCode);object._cocoonjs_proxy_object_data=null;delete this.proxyObjects[proxyObjectKey];}};parentObject[typeName]._cocoonjs_proxy_type_data.callProxyObjectEventHandler=function(id,eventHandlerName){var object=this.proxyObjects[id];var eventHandler=object._cocoonjs_proxy_object_data.eventHandlers[eventHandlerName];if(eventHandler){eventHandler({target:object});}};parentObject[typeName]._cocoonjs_proxy_type_data.callProxyObjectEventListeners=function(id,eventTypeName){var object=this.proxyObjects[id];var eventListeners=object._cocoonjs_proxy_object_data.eventListeners[eventTypeName].slice();for(var i=0;i<eventListeners.length;i++){eventListeners[i]({target:object});}};}};extension.takedownOriginProxyType=function(typeName){if(Cocoon.App.nativeAvailable){var parentObject=window;if(parentObject[typeName]&&parentObject[typeName]._cocoonjs_proxy_type_data){parentObject[typeName]=parentObject[typeName]._cocoonjs_proxy_type_data.originalType;}}};extension.deleteOriginProxyObject=function(object){if(Cocoon.App.nativeAvailable){var parentObject=window;if(object&&object._cocoonjs_proxy_object_data){parentObject[object._cocoonjs_proxy_object_data.typeName]._cocoonjs_proxy_type_data.deleteProxyObject(object);}}};extension.callOriginProxyObjectEventHandler=function(typeName,id,eventHandlerName){if(Cocoon.App.nativeAvailable){var parentObject=window;parentObject[typeName]._cocoonjs_proxy_type_data.callProxyObjectEventHandler(id,eventHandlerName);}};extension.callOriginProxyObjectEventListeners=function(typeName,id,eventTypeName){if(Cocoon.App.nativeAvailable){var parentObject=window;parentObject[typeName]._cocoonjs_proxy_type_data.callProxyObjectEventListeners(id,eventTypeName);}};extension.setupDestinationProxyType=function(typeName,eventHandlerNames){if(Cocoon.App.nativeAvailable){var parentObject=window;parentObject[typeName]._cocoonjs_proxy_type_data={nextId:0,proxyObjects:{},eventHandlerNames:eventHandlerNames};}};extension.takedownDestinationProxyType=function(typeName){if(Cocoon.App.nativeAvailable){var parentObject=window;if(parent[typeName]&&parentObject[typeName]._cocoonjs_proxy_type_data){delete parentObject[typeName]._cocoonjs_proxy_type_data;}}};extension.newDestinationProxyObject=function(typeName){if(Cocoon.App.nativeAvailable){var parentObject=window;var proxyObject=new parentObject[typeName]();proxyObject._cocoonjs_proxy_object_data={};proxyObject._cocoonjs_proxy_object_data.typeName=typeName;var proxyObjectId=parentObject[typeName]._cocoonjs_proxy_type_data.nextId;parentObject[typeName]._cocoonjs_proxy_type_data.proxyObjects[proxyObjectId]=proxyObject;proxyObject._cocoonjs_proxy_object_data.id=proxyObjectId;parentObject[typeName]._cocoonjs_proxy_type_data.nextId++;for(var i=0;i<parentObject[typeName]._cocoonjs_proxy_type_data.eventHandlerNames.length;i++){(function(eventHandlerName){proxyObject[eventHandlerName]=function(event){var proxyObject=this;var jsCode="Cocoon.App.callOriginProxyObjectEventHandler("+JSON.stringify(proxyObject._cocoonjs_proxy_object_data.typeName)+", "+proxyObject._cocoonjs_proxy_object_data.id+", "+JSON.stringify(eventHandlerName)+");";Cocoon.App.forwardAsync(jsCode);};})(parentObject[typeName]._cocoonjs_proxy_type_data.eventHandlerNames[i]);}
proxyObject._cocoonjs_proxy_object_data.eventListeners={};return proxyObjectId;}};extension.callDestinationProxyObjectFunction=function(typeName,id,functionName){if(Cocoon.App.nativeAvailable){var parentObject=window;var argumentsArray=Array.prototype.slice.call(arguments);argumentsArray.splice(0,3);var proxyObject=parentObject[typeName]._cocoonjs_proxy_type_data.proxyObjects[id];var result=proxyObject[functionName].apply(proxyObject,argumentsArray);return result;}};extension.setDestinationProxyObjectAttribute=function(typeName,id,attributeName,attributeValue){if(Cocoon.App.nativeAvailable){var parentObject=window;var proxyObject=parentObject[typeName]._cocoonjs_proxy_type_data.proxyObjects[id];proxyObject[attributeName]=attributeValue;}};extension.getDestinationProxyObjectAttribute=function(typeName,id,attributeName){if(Cocoon.App.nativeAvailable){var parentObject=window;var proxyObject=parentObject[typeName]._cocoonjs_proxy_type_data.proxyObjects[id];return proxyObject[attributeName];}};extension.deleteDestinationProxyObject=function(typeName,id){if(Cocoon.App.nativeAvailable){var parentObject=window;delete parentObject[typeName]._cocoonjs_proxy_type_data.proxyObjects[id];}};extension.addDestinationProxyObjectEventListener=function(typeName,id,eventTypeName){if(Cocoon.App.nativeAvailable){var parentObject=window;var proxyObject=parentObject[typeName]._cocoonjs_proxy_type_data.proxyObjects[id];var callback=function(event){var proxyObject=this;var jsCode="Cocoon.Proxify.callOriginProxyObjectEventListeners("+JSON.stringify(proxyObject._cocoonjs_proxy_object_data.typeName)+", "+proxyObject._cocoonjs_proxy_object_data.id+", "+JSON.stringify(eventTypeName)+");";Cocoon.App.forwardAsync(jsCode);};proxyObject._cocoonjs_proxy_object_data.eventListeners[eventTypeName]=callback;proxyObject.addEventListener(eventTypeName,callback);}};extension.xhr=function(){var ATTRIBUTE_NAMES=["timeout","withCredentials","upload","status","statusText","responseType","response","responseText","responseXML","readyState"];var FUNCTION_NAMES=["open","setRequestHeader","send","abort","getResponseHeader","getAllResponseHeaders","overrideMimeType"];var EVENT_HANDLER_NAMES=["onloadstart","onprogress","onabort","onerror","onload","ontimeout","onloadend","onreadystatechange"];Cocoon.Proxify.setupOriginProxyType("XMLHttpRequest",ATTRIBUTE_NAMES,FUNCTION_NAMES,EVENT_HANDLER_NAMES);};extension.audio=function(){var ATTRIBUTE_NAMES=["src","loop","volume","preload"];var FUNCTION_NAMES=["play","pause","load","canPlayType"];var EVENT_HANDLER_NAMES=["onended","oncanplay","oncanplaythrough","onerror"];Cocoon.Proxify.setupOriginProxyType("Audio",ATTRIBUTE_NAMES,FUNCTION_NAMES,EVENT_HANDLER_NAMES);};extension.console=function()
{if(!Cocoon.nativeAvailable)return;if(typeof Cocoon.originalConsole==='undefined')
{Cocoon.originalConsole=window.console;}
var functions=["log","error","info","debug","warn"];var newConsole={};for(var i=0;i<functions.length;i++)
{newConsole[functions[i]]=function(functionName)
{return function(message)
{try{var jsCode="Proxified log: "+JSON.stringify(message);Cocoon.originalConsole.log(jsCode);ext.IDTK_APP.makeCallAsync("forward",jsCode);}catch(e){console.log("Proxified log: "+e);}};}(functions[i]);}
if(!newConsole.assert){newConsole.assert=function assert(){if(arguments.length>0&&!arguments[0]){var str='Assertion failed: '+(arguments.length>1?arguments[1]:'');newConsole.error(str);}};}
window.console=newConsole;};extension.deproxifyConsole=function()
{if(window.navigator.isCocoonJS||!Cocoon.nativeAvailable)return;if(typeof Cocoon.originalConsole!=='undefined')
{window.console=Cocoon.originalConsole;Cocoon.originalConsole=undefined;}};return extension;});Cocoon.define("Cocoon.Touch",function(extension){extension.addADivToDisableInput=function(){var div=document.createElement("div");div.id="CocoonJSInputBlockingDiv";div.style.left=0;div.style.top=0;div.style.width="100%";div.style.height="100%";div.style.position="absolute";div.style.backgroundColor='transparent';div.style.border="0px solid #000";div.style.zIndex=999999999;document.body.appendChild(div);};extension.removeTheDivToEnableInput=function(){var div=document.getElementById("CocoonJSInputBlockingDiv");if(div)document.body.removeChild(div);};extension.disable=function(){if(Cocoon.nativeAvailable){window.ext.IDTK_APP.makeCall("disableTouchLayer","CocoonJSView");}
else if(!navigator.isCocoonJS){if(!Cocoon.App.EmulatedWebViewIFrame){Cocoon.App.forwardEventsToCocoonJSEnabled=false;Cocoon.App.forwardAsync("Cocoon && Cocoon.Touch && Cocoon.Touch.disable();");}}};extension.enable=function(){if(Cocoon.nativeAvailable){window.ext.IDTK_APP.makeCall("enableTouchLayer","CocoonJSView");}
else if(!navigator.isCocoonJS){if(!Cocoon.App.EmulatedWebViewIFrame){Cocoon.App.forwardEventsToCocoonJSEnabled=true;Cocoon.App.forwardAsync("Cocoon && Cocoon.Touch && Cocoon.Touch.enable();");}}};extension.disableInWebView=function(){if(Cocoon.nativeAvailable){window.ext.IDTK_APP.makeCall("disableTouchLayer","WebView");}
else if(!navigator.isCocoonJS){if(!Cocoon.App.EmulatedWebViewIFrame){Cocoon.Touch.addADivToDisableInput();}
else{Cocoon.App.forwardAsync("Cocoon && Cocoon.Touch && Cocoon.Touch.disableInWebView();");}}};extension.enableInWebView=function(){if(Cocoon.nativeAvailable){window.ext.IDTK_APP.makeCall("enableTouchLayer","WebView");}
else if(!navigator.isCocoonJS){if(!Cocoon.App.EmulatedWebViewIFrame){Cocoon.Touch.removeTheDivToEnableInput();}
else{Cocoon.Touch.forwardAsync("Cocoon && Cocoon.Touch && Cocoon.Touch.enableInWebView();");}}};return extension;});Cocoon.define("Cocoon.Utils",function(extension){"use strict";extension.logMemoryInfo=function()
{if(Cocoon.nativeAvailable&&navigator.isCocoonJS)
{return Cocoon.callNative("IDTK_APP","logMemoryInfo",arguments);}};extension.textureReduction=function(sizeThreshold,applyTo,forbidFor)
{if(Cocoon.nativeAvailable&&navigator.isCocoonJS)
{return Cocoon.callNative("IDTK_APP","setDefaultTextureReducerThreshold",arguments);}};extension.markAsMusic=function(audioFilePath)
{if(Cocoon.nativeAvailable)
{return Cocoon.callNative("IDTK_APP","addForceMusic",arguments);}};extension.captureScreen=function(fileName,storageType,captureType,saveToGallery){if(Cocoon.nativeAvailable){return Cocoon.callNative("IDTK_APP","captureScreen",arguments);}};extension.captureScreenAsync=function(fileName,storageType,captureType,saveToGallery,callback){if(Cocoon.nativeAvailable){Cocoon.callNative("IDTK_APP","captureScreen",arguments,true);}};extension.setAntialias=function(enable)
{if(Cocoon.nativeAvailable&&navigator.isCocoonJS)
{return Cocoon.callNative("IDTK_APP","setDefaultAntialias",arguments);}};extension.setWebGLEnabled=function(enabled)
{if(Cocoon.nativeAvailable)
{return Cocoon.callNative("IDTK_APP","setDefaultAntialias",arguments);}};extension.setNPOTEnabled=function(enabled){if(Cocoon.nativeAvailable&&navigator.isCocoonJS){return window.ext.IDTK_APP.makeCall("setNPOTEnabled",enabled);}};extension.setMaxMemory=function(memoryInMBs){if(Cocoon.nativeAvailable&&navigator.isCocoonJS){return window.ext.IDTK_APP.makeCall("setMaxMemory",memoryInMBs);}};extension.CaptureType={EVERYTHING:0,COCOONJS_GL_SURFACE:1,JUST_SYSTEM_VIEWS:2};extension.existsPath=function(path,storageType){if(Cocoon.nativeAvailable){return Cocoon.callNative("IDTK_APP","existsPath",arguments);}
return false;};extension.setTextCacheSize=function(size){if(Cocoon.nativeAvailable&&navigator.isCocoonJS){return Cocoon.callNative("IDTK_APP","setTextCacheSize",arguments);}};return extension;});Cocoon.define("Cocoon.WebView",function(extension){if(typeof Cocoon==='undefined'||Cocoon===null)return extension;if(typeof Cocoon.App==='undefined'||Cocoon.App===null)return extension;if(navigator.isCocoonJS)return extension;extension.show=function(x,y,width,height)
{if(Cocoon.App.nativeAvailable)
{return Cocoon.callNative("IDTK_APP","show",arguments);}
else
{var div=window.parent.document.getElementById('CocoonJS_App_ForCocoonJS_WebViewDiv');div.style.left=(x?x:div.style.left)+'px';div.style.top=(y?y:div.style.top)+'px';div.style.width=(width?width/window.devicePixelRatio:window.parent.innerWidth)+'px';div.style.height=(height?height/window.devicePixelRatio:window.parent.innerHeight)+'px';div.style.display="block";var iframe=window.parent.document.getElementById('CocoonJS_App_ForCocoonJS_WebViewIFrame');iframe.style.width=(width?width/window.devicePixelRatio:window.parent.innerWidth)+'px';iframe.style.height=(height?height/window.devicePixelRatio:window.parent.innerHeight)+'px';}};extension.hide=function()
{if(Cocoon.App.nativeAvailable)
{return Cocoon.callNative("IDTK_APP","hide",arguments);}
else
{window.parent.document.getElementById('CocoonJS_App_ForCocoonJS_WebViewDiv').style.display="none";}};extension.loadInCocoon=function(path,callbacks,storageType)
{if(Cocoon.App.nativeAvailable)
{var javaScriptCodeToForward="ext.IDTK_APP.makeCall('loadPath'";if(typeof path!=='undefined')
{javaScriptCodeToForward+=", '"+path+"'";if(typeof storageType!=='undefined')
{javaScriptCodeToForward+=", '"+storageType+"'";}}
javaScriptCodeToForward+=");";return Cocoon.App.forwardAsync(javaScriptCodeToForward);}
else
{Cocoon.App.forwardAsync("Cocoon.App.load('"+path+"');");}};extension.reloadCocoonJS=function()
{if(Cocoon.App.nativeAvailable)
{return Cocoon.App.forwardAsync("ext.IDTK_APP.makeCall('reload');");}
else if(!navigator.isCocoonJS)
{window.parent.location.reload();}};window.addEventListener("load",function()
{if(!Cocoon.App.nativeAvailable&&window.name=='CocoonJS_App_ForCocoonJS_WebViewIFrame'){Cocoon.App.forwardEventsToCocoonJSEnabled=false;var EVENT_ATTRIBUTES=['timeStamp','button','type','x','y','pageX','pageY','clientX','clientY','offsetX','offsetY'];var EVENTS=["dblclick","touchmove","mousemove","touchend","touchcancel","mouseup","touchstart","mousedown","release","dragleft","dragright","swipeleft","swiperight"];var forwardEventToCocoonJS=function(eventName,event){var eventData={};for(var att in event){var i=EVENT_ATTRIBUTES.indexOf(att);if(i>=0){eventData[att]=event[att];}}
var jsCode="Cocoon && Cocoon.App && Cocoon.App.forwardedEventFromTheWebView && Cocoon.App.forwardedEventFromTheWebView("+JSON.stringify(eventName)+", '"+JSON.stringify(eventData)+"');";Cocoon.App.forward(jsCode);};for(var i=0;i<EVENTS.length;i++){window.addEventListener(EVENTS[i],(function(eventName){return function(event){if(Cocoon.App.forwardEventsToCocoonJSEnabled){forwardEventToCocoonJS(eventName,event);}};})(EVENTS[i]));}}});extension.onLoadInCocoonJSSucceed=new Cocoon.EventHandler("IDTK_APP","App","forwardpageload");extension.onLoadInCocoonJSFailed=new Cocoon.EventHandler("IDTK_APP","App","forwardpagefail");return extension;});Cocoon.define("Cocoon.Widget",function(extension){"use strict";extension.WebDialog=function(){if(Cocoon.App.nativeAvailable){this.webDialogID=window.ext.IDTK_APP.makeCall("createWebDialog");}
else{var iframe=document.createElement("iframe");iframe.id="CocoonJSWebDialogIFrame";iframe.name="CocoonJSWebDialogIFrame";iframe.style.cssText="position:fixed;left:0;top:0;bottom:0;right:0; width:100%; height:100%;margin:0;padding:0;";var me=this;iframe.onload=function(){me.iframeloaded=true;var js="Cocoon = {}; Cocoon.Widget = {}; Cocoon.Widget.WebDialog = {}; Cocoon.Widget.WebDialog.close = function()"+"{"+"   window.parent.CocoonJSCloseWebDialog();"+"};";me.evalIframe(js);for(var i=0;i<me.pendingEvals.length;++i){me.evalIframe(me.pendingEvals[i]);}
me.pendingEvals=[];};iframe.onerror=function(){me.close();};this.iframe=iframe;this.pendingEvals=[];window.CocoonJSCloseWebDialog=function(){me.close();};}};extension.WebDialog.prototype={show:function(url,callback){this.closeCallback=function(){Cocoon.Touch.enable();if(callback)
callback();};if(Cocoon.App.nativeAvailable){Cocoon.Touch.disable();return window.ext.IDTK_APP.makeCallAsync("showWebDialog",this.webDialogID,url,this.closeCallback);}
else{this.iframe.src=url;document.body.appendChild(this.iframe);}},close:function(){if(Cocoon.App.nativeAvailable){return window.ext.IDTK_APP.makeCallAsync("closeWebDialog",this.webDialogID);}
else{if(this.iframe.parentNode){this.iframe.parentNode.removeChild(this.iframe);}}
if(this.closeCallback)
this.closeCallback();},evalIframe:function(js){window.frames.CocoonJSWebDialogIFrame.eval(js);},eval:function(js){if(Cocoon.App.nativeAvailable){return window.ext.IDTK_APP.makeCallAsync("evalWebDialog",this.webDialogID,js);}
else{if(this.iframeloaded)
this.evalIframe(js);else
this.pendingEvals.push(js);}}};return extension;});
